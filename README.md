# Malware Analysis

An E-book of malware analysis applications.You can download the programs used here from the applications folder.

Will be constantly updated...

# DOCUMENT

1-)<a href="https://github.com/ysfcndgr/Malware-Analysis#zeus-botnet-memory-analysis">Zeus Botnet Memory Analysis</a>

2-)<a href="https://github.com/ysfcndgr/Malware-Analysis#stuxnet-memory-analysis">Stuxnet Memory Analysis</a>



# Zeus Botnet Memory Analysis

We will analyze memory dump with Volatility.
We run the following command to find out from which system the image was taken.


<code>vol.exe -f zeus.vmem imageinfo </code>

![1](https://user-images.githubusercontent.com/32979760/111479163-c6087880-8741-11eb-9eac-0a1beae645ca.PNG)

Processes taken in the image are displayed with the following command.

<code>vol.exe -f zeus.vmem pstree</code>

![2](https://user-images.githubusercontent.com/32979760/111479933-7fffe480-8742-11eb-8156-49bdc874b55c.PNG)

There doesn't appear to be a problem with running processes.
We will check if there is a connection to the machine and if there is a connection to the machine, we will find out which process started via PiD.

<code>vol.exe -f zeus.vmem connscan</code>

![3](https://user-images.githubusercontent.com/32979760/111481066-a6724f80-8743-11eb-9ec0-9c92d5ed5f9e.PNG)

When we look at the screenshot above, we see that svchost.exe connects to the connection on port 80.This is not normal for svchost.exe.
(For more information on svchost.exe, see here. https://www.howtogeek.com/howto/windows-vista/what-is-svchostexe-and-why-is-it-running/ )

We continue

We check whether the address 193.104.41.75 is in the black list via ipvoid.com.

![4](https://user-images.githubusercontent.com/32979760/111482693-3369d880-8745-11eb-8d0f-5e9eab88b57b.PNG)

We see that the result is clean.


We check the ip address on the malwaredomain.com site.

![5](https://user-images.githubusercontent.com/32979760/111530822-d2f28f80-8774-11eb-8c6a-bc025803b9da.PNG)

It has been observed that the ip address is distributing malicious files and the description is zeus botnet.

Let's see if the malicious file runs itself at startup.

<code>vol.exe -f zeus.vmem printkey -K "Microsoft\Windows NT\CurrentVersion\Winlogon"</code>

![6](https://user-images.githubusercontent.com/32979760/111627005-ab94d480-87ff-11eb-82c5-07568f1521ce.PNG)

As seen in the screenshot, sdra64.exe runs itself automatically.

We are now looking for a malicious signature.

<code>vol.exe -f zeus.vmem malfind -D dump</code>

I saved the output under the dump folder.
We see svchost.exe in the output.

![7](https://user-images.githubusercontent.com/32979760/111628395-3aeeb780-8801-11eb-8e62-875012f8ab95.PNG)


Now with piD, the malware signature is saved under the dump folder

<code>vol.exe -f zeus.vmem malfind -D dump/ -p 856</code>

The output in the dump folder was scanned at virustotal.com.
and once again we see that the malware is Zbot.

![8](https://user-images.githubusercontent.com/32979760/111629784-b866f780-8802-11eb-884b-a994ccf8977b.PNG)


# Stuxnet Memory Analysis

What is stuxnet?


Stuxnet is worm software used by the US and Israel to disrupt Iran's nuclear operations. The virus, whose existence was revealed in June 2010, affected Iran's nuclear facilities in Bushehr and Natanz.(search for more information)
We are looking at image information
<code>  vol.exe -f stuxnet.vmem imageinfo</code> 

then we view the processes in the system.

<code>vol.exe -f stuxnet.vmem pslist</code>

![10](https://user-images.githubusercontent.com/32979760/111702483-60091780-884d-11eb-921e-0093ae01a330.PNG)
![11](https://user-images.githubusercontent.com/32979760/111702486-60a1ae00-884d-11eb-8b05-c1be4f3f90b9.PNG)

It is doubtful to have 3 identical lsass.exe processes.

<code> vol.exe -f stuxnet.vmem pstree </code>

We are viewing the start time of processes.
